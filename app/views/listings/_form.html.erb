
<div class="container">

<%= form_with(model: listing, local: true) do |form| %>
  <% if listing.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(listing.errors.count, "error") %> prohibited this listing from being saved:</h2>

      <ul>
      <% listing.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= form.label :title %>
    <%= form.text_field :title %>
  </div>

  <div class="field">
    <%= form.label :description %>
    <%= form.text_area :description %>
  </div>

<div>
  <%= form.label :category_id %>
  <%= form.select(:category_id, @categories.map {|b| [b.name, b.id]}) %>
</div>

  <div class="field">
    <%= form.label :suburb %>
    <%= form.text_field :suburb %>
  </div>

  <div class="field">
    <%= form.label :city %>
    <%= form.text_field :city %>
  </div>

  <div class="field">
    <%= form.label :price %>
    <%= form.text_field :price %>
  </div>

  <div class="field">
    <%= form.label :deposit %>
    <%= form.text_field :deposit %>
  </div>
  
  
  <label for="from"><%=:From%></label>
  <input type="text" id="from" name="datefrom">
  <label for="to"><%=:To%></label>
  <input type="text" id="to" name="dateto">

  <script>
  var unavailableDates = ["19-2-2015", "20-2-2015", "23-2-2015", "24-2-2015"]

  function unavailable(date) {
      dmy = date.getDate() + "-" + (date.getMonth() + 1) + "-" + date.getFullYear();
      if (jQuery.inArray(dmy, unavailableDates) == -1) {
          return [true, ""];
      } else {
          return [false, "", "Unavailable"];
      }
  }
  
  $(function() {
      $( "#from" ).datepicker({
          defaultDate: "+1w",
          changeMonth: true,
          beforeShowDay: unavailable,
          numberOfMonths: 1,
          dateFormat: 'dd/mm/yy',
          onClose: function( selectedDate ) {
              $( "#from" ).datepicker( "option", "minDate", selectedDate);

              var jsDate = $('#from').datepicker('getDate');
                if (jsDate !== null) { // if any date selected in datepicker
                    jsDate instanceof Date; // -> true
                    jsDate.getDate();
                    jsDate.getMonth();
                    jsDate.getFullYear();
              }
          }
      });
      
      $( "#to" ).datepicker({
          defaultDate: "+1w",
          changeMonth: true,
          beforeShowDay: unavailable,
          numberOfMonths: 1,
          dateFormat: 'dd/mm/yy',
          onClose: function( selectedDate ) {
              $( "#to" ).datepicker( "option", "maxDate", selectedDate);
             
              var jsDate = $('#to').datepicker('getDate');
              if (jsDate !== null) { // if any date selected in datepicker
                  jsDate instanceof Date; // -> true
                  jsDate.getDate();
                  jsDate.getMonth();
                  jsDate.getFullYear();
            }
          }
      });
  });
  </script>

  <div class="field">
  <%= form.label :picture %> <%= form.file_field :picture, accept:
  'image/png,image/gif,image/jpeg,image/jpg' %>
  </div>

  <div class="actions">
    <%= form.submit %>
  </div>
<% end %>
</div>